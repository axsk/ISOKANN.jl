<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ISOKANN.jl · ISOKANN</title><meta name="title" content="ISOKANN.jl · ISOKANN"/><meta property="og:title" content="ISOKANN.jl · ISOKANN"/><meta property="twitter:title" content="ISOKANN.jl · ISOKANN"/><meta name="description" content="Documentation for ISOKANN."/><meta property="og:description" content="Documentation for ISOKANN."/><meta property="twitter:description" content="Documentation for ISOKANN."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>ISOKANN</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>ISOKANN.jl</a><ul class="internal"><li><a class="tocitem" href="#Main-entry-points"><span>Main entry points</span></a></li><li><a class="tocitem" href="#Public-API"><span>Public API</span></a></li><li><a class="tocitem" href="#Internal-API"><span>Internal API</span></a></li></ul></li><li><a class="tocitem" href="installation/">Installation</a></li><li><a class="tocitem" href="introduction/">Introduction</a></li><li><a class="tocitem" href="isomu/">IsoMu</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>ISOKANN.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ISOKANN.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/axsk/ISOKANN.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/axsk/ISOKANN.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ISOKANN.jl"><a class="docs-heading-anchor" href="#ISOKANN.jl">ISOKANN.jl</a><a id="ISOKANN.jl-1"></a><a class="docs-heading-anchor-permalink" href="#ISOKANN.jl" title="Permalink"></a></h1><p>Documentation for ISOKANN.jl</p><h2 id="Main-entry-points"><a class="docs-heading-anchor" href="#Main-entry-points">Main entry points</a><a id="Main-entry-points-1"></a><a class="docs-heading-anchor-permalink" href="#Main-entry-points" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>IsoRun</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.run!" href="#ISOKANN.run!"><code>ISOKANN.run!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run!(iso::Iso2, n=1, epochs=1)</code></pre><p>Run the training process for the Iso2 model.</p><p><strong>Arguments</strong></p><ul><li><code>iso::Iso2</code>: The Iso2 model to train.</li><li><code>n::Int</code>: The number of (outer) Koopman iterations.</li><li><code>epochs::Int</code>: The number of (inner) epochs to train the model for each Koopman evaluation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L52-L61">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>MollyLangevin</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.propagate" href="#ISOKANN.propagate"><code>ISOKANN.propagate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">propagate(s::OpenMMSimulation, x0::AbstractMatrix{T}, ny; nthreads=Threads.nthreads(), mmthreads=1) where {T}</code></pre><p>Propagates <code>ny</code> replicas of the OpenMMSimulation <code>s</code> from the inintial states <code>x0</code>.</p><p><strong>Arguments</strong></p><ul><li><code>s</code>: An instance of the OpenMMSimulation type.</li><li><code>x0</code>: Matrix containing the initial states as columns</li><li><code>ny</code>: The number of replicas to create.</li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>nthreads</code>: The number of threads to use for parallelization of multiple simulations.</li><li><code>mmthreads</code>: The number of threads to use for each OpenMM simulation. Set to &quot;gpu&quot; to use the GPU platform.</li></ul><p>Note: For CPU we observed better performance with nthreads = num cpus, mmthreads = 1 then the other way around. With GPU nthreads &gt; 1 should be supported, but on our machine lead to slower performance then nthreads=1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulators/openmm.jl#L129-L145">source</a></section></article><h2 id="Public-API"><a class="docs-heading-anchor" href="#Public-API">Public API</a><a id="Public-API-1"></a><a class="docs-heading-anchor-permalink" href="#Public-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.Iso2-Tuple{Any}" href="#ISOKANN.Iso2-Tuple{Any}"><code>ISOKANN.Iso2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Iso2(data; opt=AdamRegularized(), model=pairnet(data), gpu=false, kwargs...)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L19-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.Iso2-Tuple{ISOKANN.IsoSimulation}" href="#ISOKANN.Iso2-Tuple{ISOKANN.IsoSimulation}"><code>ISOKANN.Iso2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Iso2(sim::IsoSimulation; nx=100, nk=10, nd=1, kwargs...)</code></pre><p>Convenience constructor which generates the <code>SimulationData</code> from the simulation <code>sim</code> and constructs the Iso2 object. See also Iso2(data; kwargs...)</p><p><strong>Arguments</strong></p><ul><li><code>sim::IsoSimulation</code>: The <code>IsoSimulation</code> object.</li><li><code>nx::Int</code>: The number of starting points.</li><li><code>nk::Int</code>: The number of koopman samples.</li><li><code>nd::Int</code>: Dimension of the χ function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L32-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.SimulationData" href="#ISOKANN.SimulationData"><code>ISOKANN.SimulationData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct SimulationData{S,D,C,F}</code></pre><p>A struct combining a simulation with the simulated coordinates and corresponding ISOKANN trainingsdata</p><p><strong>Fields</strong></p><ul><li><code>sim::S</code>: The simulation object.</li><li><code>data::D</code>: The ISOKANN trainings data.</li><li><code>coords::C</code>: The orginal coordinates of the simulations.</li><li><code>featurizer::F</code>: A function mapping coordinates to ISOKANN features.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulation.jl#L33-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.SimulationData-Tuple{ISOKANN.IsoSimulation, Int64, Int64}" href="#ISOKANN.SimulationData-Tuple{ISOKANN.IsoSimulation, Int64, Int64}"><code>ISOKANN.SimulationData</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SimulationData(sim::IsoSimulation, nx::Int, nk::Int; ...)
SimulationData(sim::IsoSimulation, xs::AbstractMatrix, nk::Int; ...)
SimulationData(sim::IsoSimulation, (xs,ys); ...)</code></pre><p>Generates SimulationData from a simulation with either</p><ul><li><code>nx</code> initial points and <code>nk</code> Koopman samples</li><li><code>xs</code> as initial points and <code>nk</code> Koopman sample</li><li><code>xs</code> as inintial points and <code>ys</code> as Koopman samples</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulation.jl#L53-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.AdamRegularized" href="#ISOKANN.AdamRegularized"><code>ISOKANN.AdamRegularized</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Adam with L2 regularization. Note that this is different from AdamW (Adam+WeightDecay) (c.f. Decay vs L2 Reg.) </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/models.jl#L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.pairnet" href="#ISOKANN.pairnet"><code>ISOKANN.pairnet</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Fully connected neural network with <code>layers</code> layers from <code>n</code> to <code>nout</code> dimensions. <code>features</code> allows to pass a featurizer as preprocessor, <code>activation</code> determines the activation function for each but the last layer <code>lastactivation</code> can be used to modify the last layers activation function </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/models.jl#L51-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.reactionpath_minimum" href="#ISOKANN.reactionpath_minimum"><code>ISOKANN.reactionpath_minimum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">reactionpath_minimum(iso::Iso2, x0; steps=100)</code></pre><p>Compute the reaction path by integrating ∇χ with orthogonal energy minimization.</p><p><strong>Arguments</strong></p><ul><li><code>iso::Iso2</code>: The isomer for which the reaction path minimum is to be computed.</li><li><code>x0</code>: The starting point for the reaction path computation.</li><li><code>steps=100</code>: The number of steps to take along the reaction path.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/reactionpath.jl#L17-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.reactionpath_ode-Tuple{Any, Any}" href="#ISOKANN.reactionpath_ode-Tuple{Any, Any}"><code>ISOKANN.reactionpath_ode</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reactionpath_ode(iso, x0; steps=101, extrapolate=0, orth=0.01, solver=OrdinaryDiffEq.Tsit5(), dt=1e-3, kwargs...)</code></pre><p>Compute the reaction path by integrating ∇χ as well as <code>orth</code> * F orthogonal to ∇χ where F is the original force field.</p><p><strong>Arguments</strong></p><ul><li><code>iso::Iso2</code>: The isomer for which the reaction path minimum is to be computed.</li><li><code>x0</code>: The starting point for the reaction path computation.</li><li><code>steps=100</code>: The number of steps to take along the reaction path.</li><li><code>minimize=false</code>: Whether to minimize the orthogonal to ∇χ before integration.</li><li><code>extrapolate=0</code>: How fast to extrapolate beyond χ 0 and 1.</li><li><code>orth=0.01</code>: The weight of the orthogonal force field.</li><li><code>solver=OrdinaryDiffEq.Tsit5()</code>: The solver to use for the ODE integration.</li><li><code>dt=1e-3</code>: The initial time step for the ODE integration.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/reactionpath.jl#L72-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.run!" href="#ISOKANN.run!"><code>ISOKANN.run!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">run!(iso::Iso2, n=1, epochs=1)</code></pre><p>Run the training process for the Iso2 model.</p><p><strong>Arguments</strong></p><ul><li><code>iso::Iso2</code>: The Iso2 model to train.</li><li><code>n::Int</code>: The number of (outer) Koopman iterations.</li><li><code>epochs::Int</code>: The number of (inner) epochs to train the model for each Koopman evaluation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L52-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.runadaptive!-Tuple{Any}" href="#ISOKANN.runadaptive!-Tuple{Any}"><code>ISOKANN.runadaptive!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">runadaptive!(iso; generations=1, nx=10, iter=100, cutoff=Inf)</code></pre><p>Train iso with adaptive sampling. Sample <code>nx</code> new data points followed by <code>iter</code> isokann iterations and repeat this <code>generations</code> times. <code>cutoff</code> specifies the maximal data size, after which new data overwrites the oldest data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L127-L132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.save_reactive_path" href="#ISOKANN.save_reactive_path"><code>ISOKANN.save_reactive_path</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">save_reactive_path(iso::Iso2, coords::AbstractMatrix;
    sigma=1,
    out=&quot;out/reactive_path.pdb&quot;,
    source,
    kwargs...)</code></pre><p>Extract and save the reactive path of a given <code>iso</code>.</p><p>Computes the maximum likelihood path with parameter <code>sigma</code> along the given data points, aligns it and saves it to the <code>out</code> path.</p><p><strong>Arguments</strong></p><ul><li><code>iso::Iso2</code>: The isomer for which the reactive path is computed.</li><li><code>coords::AbstractMatrix</code>: The coordinates corresponding to the samples in <code>iso</code></li><li><code>sigma=1</code>: The standard deviation used for the reactive path calculation.</li><li><code>out=&quot;out/reactive_path.pdb&quot;</code>: The output file path for saving the reactive path.</li><li><code>source</code>: The source .pdb file</li></ul><p>= <code>kwargs...</code>: additional parameters passed to <code>reactive_path</code>.</p><p><strong>Returns</strong></p><ul><li><code>ids</code>: The IDs of the reactive path.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/reactionpath2.jl#L111-L134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.OpenMM.OpenMMSimulation" href="#ISOKANN.OpenMM.OpenMMSimulation"><code>ISOKANN.OpenMM.OpenMMSimulation</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A Simulation wrapping the Python OpenMM Simulation object </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulators/openmm.jl#L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.OpenMM.OpenMMSimulation-Tuple{}" href="#ISOKANN.OpenMM.OpenMMSimulation-Tuple{}"><code>ISOKANN.OpenMM.OpenMMSimulation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">OpenMMSimulation(; pdb=DEFAULT_PDB, ligand=&quot;&quot;, forcefields=[&quot;amber14-all.xml&quot;, &quot;amber14/tip3pfb.xml&quot;], temp=298, friction=1, step=0.002, steps=100, features=nothing, minimize=false)</code></pre><p>Constructs an OpenMM simulation object.</p><p><strong>Arguments</strong></p><ul><li><code>pdb::String</code>: Path to the PDB file.</li><li><code>ligand::String</code>: Path to ligand file.</li><li><code>forcefields::Vector{String}</code>: List of force field XML files.</li><li><code>temp::Float64</code>: Temperature in Kelvin.</li><li><code>friction::Float64</code>: Friction coefficient in 1/picosecond.</li><li><code>step::Float64</code>: Integration step size in picoseconds.</li><li><code>steps::Int</code>: Number of simulation steps.</li><li><code>features</code>: Which features to use for learning the chi function.             -  A vector of <code>Int</code> denotes the indices of all atoms to compute the pairwise distances from.             -  A vector of CartesianIndex{2} computes the specific distances between the atom pairs.             -  A number denotes the radius below which all pairs of atoms will be used (computed only on the starting configuration)             -  If <code>nothing</code> all pairwise distances are used.</li><li><code>minimize::Bool</code>: Whether to perform energy minimization on first state.</li><li><code>nthreads</code>: The number of threads to use for parallelization of multiple simulations.</li><li><code>mmthreads</code>: The number of threads to use for each OpenMM simulation. Set to &quot;gpu&quot; to use the GPU platform.</li></ul><p><strong>Returns</strong></p><ul><li><code>OpenMMSimulation</code>: An OpenMMSimulation object.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulators/openmm.jl#L50-L75">source</a></section></article><h2 id="Internal-API"><a class="docs-heading-anchor" href="#Internal-API">Internal API</a><a id="Internal-API-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.DataTuple" href="#ISOKANN.DataTuple"><code>ISOKANN.DataTuple</code></a> — <span class="docstring-category">Type</span></header><section><div><p>DataTuple = Tuple{Matrix{T},Array{T,3}} where {T&lt;:Number}</p><p>We represent data as a tuple of xs and ys.</p><p>xs is a matrix of size (d, n) where d is the dimension of the system and n the number of samples. ys is a tensor of size (d, k, n) where k is the number of koopman samples.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/data.jl#L5-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.IsoSimulation" href="#ISOKANN.IsoSimulation"><code>ISOKANN.IsoSimulation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type IsoSimulation</code></pre><p>Abstract type representing an IsoSimulation. Should implement the methods <code>getcoords</code>, <code>propagate</code>, <code>dim</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulation.jl#L8-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.Stabilize2" href="#ISOKANN.Stabilize2"><code>ISOKANN.Stabilize2</code></a> — <span class="docstring-category">Type</span></header><section><div><p>TransformStabilize(transform, last=nothing)</p><p>Wraps another transform and permutes its target to match the previous target</p><p>Currently we also have the stablilization (wrt to the model though) inside each Transform. TODO: Decide which to keep</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/isotarget.jl#L86-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.TransformISA" href="#ISOKANN.TransformISA"><code>ISOKANN.TransformISA</code></a> — <span class="docstring-category">Type</span></header><section><div><p>TransformISA(permute)</p><p>Compute the target via the inner simplex algorithm (without feasiblization routine). <code>permute</code> specifies whether to apply the stabilizing permutation </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/isotarget.jl#L45-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.TransformPseudoInv" href="#ISOKANN.TransformPseudoInv"><code>ISOKANN.TransformPseudoInv</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">TransformPseudoInv(normalize, direct, eigenvecs, permute)</code></pre><p>Compute the target by approximately inverting the action of K with the Moore-Penrose pseudoinverse.</p><p>If <code>direct==true</code> solve <code>chi * pinv(K(chi))</code>, otherwise <code>inv(K(chi) * pinv(chi)))</code>. <code>eigenvecs</code> specifies whether to use the eigenvectors of the schur matrix. <code>normalize</code> specifies whether to renormalize the resulting target vectors. <code>permute</code> specifies whether to permute the target for stability.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/isotarget.jl#L3-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.TransformShiftscale" href="#ISOKANN.TransformShiftscale"><code>ISOKANN.TransformShiftscale</code></a> — <span class="docstring-category">Type</span></header><section><div><p>TransformShiftscale()</p><p>Classical 1D shift-scale (ISOKANN 1) </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/isotarget.jl#L71-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.merge-Tuple{SimulationData, SimulationData}" href="#Base.merge-Tuple{SimulationData, SimulationData}"><code>Base.merge</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">merge(d1::SimulationData, d2::SimulationData)</code></pre><p>Merge the data and features of <code>d1</code> and <code>d2</code>, keeping the simulation and features of <code>d1</code>. Note that there is no check if simulation features agree.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulation.jl#L130-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN._pickclosestloop-Tuple{AbstractVector, AbstractVector}" href="#ISOKANN._pickclosestloop-Tuple{AbstractVector, AbstractVector}"><code>ISOKANN._pickclosestloop</code></a> — <span class="docstring-category">Method</span></header><section><div><p>scales with n=length(hs) </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/subsample.jl#L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.adddata-NTuple{4, Any}" href="#ISOKANN.adddata-NTuple{4, Any}"><code>ISOKANN.adddata</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">adddata(data::D, model, sim, ny, lastn=1_000_000)::D</code></pre><p>Generate new data for ISOKANN by adaptive subsampling using the chi-stratified/-uniform method.</p><ol><li>Adaptively subsample <code>ny</code> points from <code>data</code> uniformly along their <code>model</code> values.</li><li>propagate according to the simulation <code>model</code>.</li><li>return the newly obtained data concatenated to the input data</li></ol><p>The subsamples are taken only from the <code>lastn</code> last datapoints in <code>data</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; (xs, ys) = adddata((xs,ys), chi, mollysim)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/data.jl#L65-L80">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.adddata-Tuple{SimulationData, Any, Any}" href="#ISOKANN.adddata-Tuple{SimulationData, Any, Any}"><code>ISOKANN.adddata</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">adddata(d::SimulationData, model, n)</code></pre><p>χ-stratified subsampling. Select n samples amongst the provided ys/koopman points of <code>d</code> such that their χ-value according to <code>model</code> is approximately uniformly distributed and propagate them. Returns a new <code>SimulationData</code> which has the new data appended.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulation.jl#L147-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.addextrapolates!-Tuple{Any, Any}" href="#ISOKANN.addextrapolates!-Tuple{Any, Any}"><code>ISOKANN.addextrapolates!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">addextrapolates!(iso, n, stepsize=0.01, steps=10)</code></pre><p>Sample new data starting points obtained by extrapolating the chi function beyond the current extrema and attach it to the <code>iso</code> objects data.</p><p>Samples <code>n</code> points at the lower and upper end each, resulting in 2n new points. <code>step</code><code>is the magnitude of chi-value-change per step and</code>steps`` is the number of steps to take. E.g. 10 steps of stepsize 0.01 result in a change in chi of about 0.1.</p><p>The obtained data is filtered such that unstable simulations should be removed, which may result in less then 2n points being added.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/extrapolate.jl#L2-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.bootstrap-Tuple{ISOKANN.IsoSimulation, Any, Any}" href="#ISOKANN.bootstrap-Tuple{ISOKANN.IsoSimulation, Any, Any}"><code>ISOKANN.bootstrap</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bootstrap(sim, nx, ny) :: DataTuple</code></pre><p>compute initial data by propagating the molecules initial state to obtain the xs and propagating them further for the ys </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/data.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.centercoords-Tuple{Any}" href="#ISOKANN.centercoords-Tuple{Any}"><code>ISOKANN.centercoords</code></a> — <span class="docstring-category">Method</span></header><section><div><p>centercoords any given states by shifting their individual 3d mean to the origin</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/molutils.jl#L4-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.chi_exit_rate-Tuple{Any, Any, Any}" href="#ISOKANN.chi_exit_rate-Tuple{Any, Any, Any}"><code>ISOKANN.chi_exit_rate</code></a> — <span class="docstring-category">Method</span></header><section><div><p>compute the chi exit rate as per Ernst, Weber (2017), chap. 3.3 </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.data_from_trajectory-Tuple{AbstractMatrix}" href="#ISOKANN.data_from_trajectory-Tuple{AbstractMatrix}"><code>ISOKANN.data_from_trajectory</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">data_from_trajectory(xs::Matrix; reverse=false) :: DataTuple</code></pre><p>Generate the lag-1 data from the trajectory <code>xs</code>. If <code>reverse</code> is true, also take the time-reversed lag-1 data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/data.jl#L109-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.exportdata" href="#ISOKANN.exportdata"><code>ISOKANN.exportdata</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">exportdata(data::AbstractArray, model, sys, path=&quot;out/data.pdb&quot;)</code></pre><p>Export data to a PDB file.</p><p>This function takes an AbstractArray <code>data</code>, sorts it according to the <code>model</code> evaluation, removes duplicates, transforms it to standard form and saves it as a PDB file  to <code>path</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/data.jl#L157-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.extrapolate" href="#ISOKANN.extrapolate"><code>ISOKANN.extrapolate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">extrapolate(iso, n, stepsize=0.1, steps=1, minimize=true)</code></pre><p>Take the <code>n</code> most extreme points of the chi-function of the <code>iso</code> object and extrapolate them by <code>stepsize</code> for <code>steps</code> steps beyond their extrema, resulting in 2n new points. If <code>minimize</code> is true, the new points are energy minimized.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/extrapolate.jl#L23-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.fixperm-Tuple{Any, Any}" href="#ISOKANN.fixperm-Tuple{Any, Any}"><code>ISOKANN.fixperm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fixperm(new, old)</code></pre><p>Permutes the rows of <code>new</code> such as to minimize L1 distance to <code>old</code>.</p><p><strong>Arguments</strong></p><ul><li><code>new</code>: The data to match to the reference data.</li><li><code>old</code>: The reference data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/isotarget.jl#L116-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.flatpairdists-Tuple{Any}" href="#ISOKANN.flatpairdists-Tuple{Any}"><code>ISOKANN.flatpairdists</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">flatpairdists(x)</code></pre><p>Assumes each col of x to be a flattened representation of multiple 3d coords. Returns the flattened pairwise distances as columns.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/pairdists.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.flattenfirst-Tuple{Any}" href="#ISOKANN.flattenfirst-Tuple{Any}"><code>ISOKANN.flattenfirst</code></a> — <span class="docstring-category">Method</span></header><section><div><p>collapse the first and second dimension of the array <code>A</code> into the first dimension </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/data.jl#L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.growmodel-Tuple{Any, Any}" href="#ISOKANN.growmodel-Tuple{Any, Any}"><code>ISOKANN.growmodel</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Given a model and return a copy with its last layer replaced with given output dimension <code>n</code> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/models.jl#L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.inputdim-Tuple{Flux.Chain}" href="#ISOKANN.inputdim-Tuple{Flux.Chain}"><code>ISOKANN.inputdim</code></a> — <span class="docstring-category">Method</span></header><section><div><p>obtain the input dimension of a Flux model </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/models.jl#L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.kabsch-Tuple{AbstractMatrix, AbstractMatrix}" href="#ISOKANN.kabsch-Tuple{AbstractMatrix, AbstractMatrix}"><code>ISOKANN.kabsch</code></a> — <span class="docstring-category">Method</span></header><section><div><p>compute R such that R*p is closest to q</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/molutils.jl#L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.koopman-Tuple{Any, Any}" href="#ISOKANN.koopman-Tuple{Any, Any}"><code>ISOKANN.koopman</code></a> — <span class="docstring-category">Method</span></header><section><div><p>evluation of koopman by shiftscale(mean(model(data))) on the data </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.load-Tuple{String}" href="#ISOKANN.load-Tuple{String}"><code>ISOKANN.load</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load(path::String, iso::Iso2)</code></pre><p>Load the Iso2 object from a JLD2 file Note that it will be loaded to the CPU, even if it was saved on the GPU. An OpenMMSimulation will be reconstructed anew from the saved pdb file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L263-L269">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.localpdistinds-Tuple{AbstractMatrix, Any}" href="#ISOKANN.localpdistinds-Tuple{AbstractMatrix, Any}"><code>ISOKANN.localpdistinds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">localpdistinds(coords::AbstractMatrix, radius)</code></pre><p>Given <code>coords</code> of shape ( 3n x frames ) return the pairs of indices whose minimal distance along all frames is at least once lower then radius</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/pairdists.jl#L59-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.model_with_opt" href="#ISOKANN.model_with_opt"><code>ISOKANN.model_with_opt</code></a> — <span class="docstring-category">Function</span></header><section><div><p>convenience wrapper returning the provided model with the default AdamW optimiser </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/models.jl#L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.outputdim-Tuple{Flux.Chain}" href="#ISOKANN.outputdim-Tuple{Flux.Chain}"><code>ISOKANN.outputdim</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Obtain the output dimension of a Flux model </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/models.jl#L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.pairdistfeatures-Tuple{AbstractVector}" href="#ISOKANN.pairdistfeatures-Tuple{AbstractVector}"><code>ISOKANN.pairdistfeatures</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pairdistfeatures(inds::AbstractVector)</code></pre><p>Returns a featurizer function which computes the pairwise distances between the particles specified by <code>inds</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/pairdists.jl#L41-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.pdists-Union{Tuple{T}, Tuple{AbstractMatrix, Array{Tuple{T, T}, 1}}} where T" href="#ISOKANN.pdists-Union{Tuple{T}, Tuple{AbstractMatrix, Array{Tuple{T, T}, 1}}} where T"><code>ISOKANN.pdists</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pdists(coords::AbstractArray, inds::Vector{&lt;:Tuple})</code></pre><p>Compute the pairwise distances between the particles specified by the tuples <code>inds</code> over all frames in <code>traj</code>. Assumes a column contains all 3n coordinates.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/pairdists.jl#L76-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.pickclosest_sort-Tuple{AbstractVector, AbstractVector}" href="#ISOKANN.pickclosest_sort-Tuple{AbstractVector, AbstractVector}"><code>ISOKANN.pickclosest_sort</code></a> — <span class="docstring-category">Method</span></header><section><div><p>pickclosest(haystack, needles)</p><p>Return the indices into haystack which lie closest to <code>needles</code> without duplicates by removing haystack candidates after a match. Note that this is not invariant under pertubations of needles</p><p>scales with n log(n) m where n=length(haystack), m=length(needles) </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/subsample.jl#L18-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.plotatoms!" href="#ISOKANN.plotatoms!"><code>ISOKANN.plotatoms!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>scatter plot of all first &quot;O&quot; atoms of the starting points <code>xs</code> as well as the &quot;O&quot; atoms from the koopman samples to the first point from <code>ys</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/plots.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.plotlossdata" href="#ISOKANN.plotlossdata"><code>ISOKANN.plotlossdata</code></a> — <span class="docstring-category">Function</span></header><section><div><p>combined plot of loss graph and current atoms </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/plots.jl#L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.reactionforce" href="#ISOKANN.reactionforce"><code>ISOKANN.reactionforce</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">reactionforce(iso, sim, x, direction, orth=1)</code></pre><p>Compute the vector <code>f</code> with colinear component to dchi/dx such that dchi/dx * f = 1 and orth*forcefield in the orthogonal space</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/reactionpath.jl#L118-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.save-Tuple{String, Iso2}" href="#ISOKANN.save-Tuple{String, Iso2}"><code>ISOKANN.save</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">save(path::String, iso::Iso2)</code></pre><p>Save the complete Iso2 object to a JLD2 file </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L254-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.savecoords" href="#ISOKANN.savecoords"><code>ISOKANN.savecoords</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">savecoords(path::String, iso::Iso2, inds=1:numobs(iso.data))</code></pre><p>Save the coordinates of the specified observation indices from the data of of <code>iso</code> to the file <code>path</code>.</p><pre><code class="nohighlight hljs">savecoords(path::String, iso::Iso2, coords::AbstractArray)</code></pre><p>Save the coordinates of the specified matrix of coordinates to a file, using the molecule in <code>iso</code> as a template.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L226-L234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.saveextrema-Tuple{String, Iso2}" href="#ISOKANN.saveextrema-Tuple{String, Iso2}"><code>ISOKANN.saveextrema</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">saveextrema(path::String, iso::Iso2)</code></pre><p>Save the two extermal configurations (metastabilities) to the file <code>path</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L244-L248">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.scatter_chifix-Tuple{Any, Any}" href="#ISOKANN.scatter_chifix-Tuple{Any, Any}"><code>ISOKANN.scatter_chifix</code></a> — <span class="docstring-category">Method</span></header><section><div><p>fixed point plot, i.e. x vs model(x) </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/plots.jl#L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.selectrows-Tuple{Any, Any}" href="#ISOKANN.selectrows-Tuple{Any, Any}"><code>ISOKANN.selectrows</code></a> — <span class="docstring-category">Method</span></header><section><div><p>given an array of arbitrary shape, select the rows <code>inds</code> in the first dimension </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/models.jl#L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.shiftscale-Tuple{Any}" href="#ISOKANN.shiftscale-Tuple{Any}"><code>ISOKANN.shiftscale</code></a> — <span class="docstring-category">Method</span></header><section><div><p>empirical shift-scale operation </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.simulationtime-Tuple{Iso2}" href="#ISOKANN.simulationtime-Tuple{Iso2}"><code>ISOKANN.simulationtime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">simulationtime(iso::Iso2)</code></pre><p>print and return the total simulation time contained in the data of <code>iso</code> in nanoseconds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/iso2.jl#L214-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.sqpairdist-Tuple{AbstractArray{&lt;:Any, 3}}" href="#ISOKANN.sqpairdist-Tuple{AbstractArray{&lt;:Any, 3}}"><code>ISOKANN.sqpairdist</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">simplepairdists(x::AbstractArray{&lt;:Any,3})</code></pre><p>Compute the pairwise distances between the columns of <code>x</code>, batched along the 3rd dimension.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/pairdists.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.subsample-Tuple{Any, AbstractMatrix, Any}" href="#ISOKANN.subsample-Tuple{Any, AbstractMatrix, Any}"><code>ISOKANN.subsample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">subsample(model, data::Array, n) :: Matrix
subsample(model, data::Tuple, n) :: Tuple</code></pre><p>Subsample <code>n</code> points of <code>data</code> uniformly in <code>model</code>. If <code>model</code> returns multiple values per sample, subsample along each dimension.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/data.jl#L48-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.subsample-Tuple{Any, Any}" href="#ISOKANN.subsample-Tuple{Any, Any}"><code>ISOKANN.subsample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">subsample(data, nx)</code></pre><p>return a random subsample of <code>nx</code> points from <code>data</code> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/data.jl#L130-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.subsample_inds-Tuple{Any, Any, Any}" href="#ISOKANN.subsample_inds-Tuple{Any, Any, Any}"><code>ISOKANN.subsample_inds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">subsample_inds(model, xs, n) :: Vector{Int}</code></pre><p>Returns <code>n</code> indices of <code>xs</code> such that <code>model(xs[inds])</code> is approximately uniformly distributed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/data.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.subsample_uniformgrid-Tuple{Any, Any}" href="#ISOKANN.subsample_uniformgrid-Tuple{Any, Any}"><code>ISOKANN.subsample_uniformgrid</code></a> — <span class="docstring-category">Method</span></header><section><div><p>subsbample_uniformgrid(ys, n) -&gt; is</p><p>given a list of values <code>ys</code>, return <code>n</code><code>indices</code>is<code>such that</code>ys[is]` are approximately uniform by picking the closest points to a randomly perturbed grid in [0,1].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/subsample.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.trajectory-Tuple{Any, Any}" href="#ISOKANN.trajectory-Tuple{Any, Any}"><code>ISOKANN.trajectory</code></a> — <span class="docstring-category">Method</span></header><section><div><p>trajectory(sim, nx) generate a trajectory of length <code>nx</code> from the simulation <code>sim</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/data.jl#L144-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.OpenMM.set_random_velocities!-Tuple{Any, Any}" href="#ISOKANN.OpenMM.set_random_velocities!-Tuple{Any, Any}"><code>ISOKANN.OpenMM.set_random_velocities!</code></a> — <span class="docstring-category">Method</span></header><section><div><p>mutates the state in sim </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulators/openmm.jl#L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.OpenMM.trajectory-Union{Tuple{OpenMMSimulation}, Tuple{T}, Tuple{OpenMMSimulation, AbstractVector{T}}, Tuple{OpenMMSimulation, AbstractVector{T}, Any}, Tuple{OpenMMSimulation, AbstractVector{T}, Any, Any}} where T" href="#ISOKANN.OpenMM.trajectory-Union{Tuple{OpenMMSimulation}, Tuple{T}, Tuple{OpenMMSimulation, AbstractVector{T}}, Tuple{OpenMMSimulation, AbstractVector{T}, Any}, Tuple{OpenMMSimulation, AbstractVector{T}, Any, Any}} where T"><code>ISOKANN.OpenMM.trajectory</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">trajectory(s::OpenMMSimulation, x0, steps=s.steps, saveevery=1; stepsize = s.step, mmthreads = s.mmthreads)</code></pre><p>Return the coordinates of a single trajectory started at <code>x0</code> for the given number of <code>steps</code> where each <code>saveevery</code> step is stored.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulators/openmm.jl#L172-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.propagate-Union{Tuple{T}, Tuple{OpenMMSimulation, AbstractMatrix{T}, Any}} where T" href="#ISOKANN.propagate-Union{Tuple{T}, Tuple{OpenMMSimulation, AbstractMatrix{T}, Any}} where T"><code>ISOKANN.propagate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">propagate(s::OpenMMSimulation, x0::AbstractMatrix{T}, ny; nthreads=Threads.nthreads(), mmthreads=1) where {T}</code></pre><p>Propagates <code>ny</code> replicas of the OpenMMSimulation <code>s</code> from the inintial states <code>x0</code>.</p><p><strong>Arguments</strong></p><ul><li><code>s</code>: An instance of the OpenMMSimulation type.</li><li><code>x0</code>: Matrix containing the initial states as columns</li><li><code>ny</code>: The number of replicas to create.</li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>nthreads</code>: The number of threads to use for parallelization of multiple simulations.</li><li><code>mmthreads</code>: The number of threads to use for each OpenMM simulation. Set to &quot;gpu&quot; to use the GPU platform.</li></ul><p>Note: For CPU we observed better performance with nthreads = num cpus, mmthreads = 1 then the other way around. With GPU nthreads &gt; 1 should be supported, but on our machine lead to slower performance then nthreads=1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulators/openmm.jl#L129-L145">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ISOKANN.randx0-Tuple{OpenMMSimulation, Any}" href="#ISOKANN.randx0-Tuple{OpenMMSimulation, Any}"><code>ISOKANN.randx0</code></a> — <span class="docstring-category">Method</span></header><section><div><p>generate <code>n</code> random inintial points for the simulation <code>mm</code> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/axsk/ISOKANN.jl/blob/e1da2a1fad47c28930782e7f7a35632726935f5e/src/simulators/openmm.jl#L117">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="installation/">Installation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Friday 7 June 2024 13:06">Friday 7 June 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
